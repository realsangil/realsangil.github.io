---
layout: post
title: "MSA (Micro Service Architecture) 란?"
tags: ['msa']
date: 2016-10-10T11:08:07+09:00
---

<!--more-->
![Micro Service Architecture](/images/2016-10-10-msa1/msa.jpg)

얼마 전부터 Node.js가 많은 개발자들이 공부하고 현업에서도 많이 사용 중에 있다.
Node.js를 알기 이전에 MSA를 먼저 알아야 한다고 생각하기에 검색하고 공부해서 나름대로 간략히 정리해 보려 한다. 

## Micro Service Architecture란?
마이크로서비스를 제일 처음 언급한 사람은 Martin Fowler라는 사람이다. 이분은 객체지향 언어를 공부해본 사람이라면 한번쯤은 들어봤을리라 생각한다. 이분이 처음 자신의 Blog에서 Microservice를 이렇게 소개하고 있다.

>마이크로서비스 아키텍처 스타일은 단일 응용 프로그램을 나누어 작은 서비스의 조합으로 구축하는 방법이며, 각 개별 서비스는 >자신의 프로세스에서 실행하는 HTTP 기반 API 등으로 가벼운 연결 방식을 사용합니다. 각 서비스는 비지니스 로직의 수행 >기능에 맞게 구축 된 완전히 자동화 된 머신에 의한 배포를 통해 이루어 집니다. 각 서비스의 최소한의 중앙 관리 기능은 있지만,>서로 다른 프로그래밍 언어에 의해 개발되고, 다른 데이터 저장 기술이 이용할 수 있습니다..
>>@Martin Fowler's Blog http://martinfowler.com/articles/microservices.html

일반적으로 개발에 사용되는 아키텍쳐인 모놀리식 스타일은 일반적인 계발 방법과 같이 프로그램을 하나의 큰 덩어리로 구축하는 것을 말한다. 모놀리식 응용 프로그램은 일반적으로 잘 작동하지만 개발할 때 문제점이 조금씩 발생하게 된다. 아주 작은 부분을 변경하더라도 모두 빌드해서 다시 배포해야 하며 이것은 최근처럼 배포주기가 짧다면 매우 비효율적이게 된다. 또한 프로그램이 점점 커지게 된다면 각 모듈의 구조를 변경없이 유지하는 것은 매우 어렵다.

![모놀리식 vs 마이크로 출처](/images/2016-10-10-msa1/monoandmicro.png)

그러나 Microservice는 작은 서비스의 결합을 통해 하나의 프로그램을 개발하는 방법으로, 각각의 서비스는 독립적인 비즈니스 로직으로 구성되며, 완전 자동화된 개발/배포환경에 의해 각각 독립적으로 배포가 가능하다. 또한 최소한의 중심적인 관리 체계가 있으며 이 시스템은 각각 다른 프로그래밍 언어, 다른 데이터스토리지 기술로 작성하는 것이 가능하다.

![분산 데이터](/images/2016-10-10-msa1/decentralised-data.png)

## 마이크로서비스 특징
 - 개발자가 관리하는 스코프가 명확해지게 되며, 이를 토대로 소프트웨어의 복잡성을 제어하는 것이 가능 최근 UI와 컨트롤, 도메인 로직이 별도의 마이크로 서비스로 구성되어 완전히 독립적으로 개발이 가능한 방향으로 나아가고 있다
 - 각각의 팀에서 독립적으로 개발/배포가 가능하여 개발팀의 운영과 스케줄링에 있어 높은 자유도를 가져다 준다.
 - 각각의 마이크로서비스는 다른 프로그래밍 언어, 다른 도구를 사용하여 개발 가능하기 때문에 요구사항을 구현하기 위해 최적화된 언어와 아키텍쳐를 선택할 수 있다.
 - 각각의 마이크로서비스는 다른 데이터저장소를 사용할 수 있으며 서로 느슨하게 연결된다.
 - DevOps와 결합된 각각의 마이크로서비스는 심플한 구조를 지니는 만큼 개발속도와 개선에 있어 높은 효용성을 지닌다. 또한 자동화된 유닛 테스트와 시나리오 테스트는 빠른 배포주기에도 불구하고 뛰어난 품질을 유지할 수 있게끔 도와준다.

## 마이크로서비스의 문제점
 - 각각의 서비스에 최적화된 DB를 사용하게 된다면 데이터 중복의 문제점이 발생할 수 있다.
 - 서비스마다 같은 언어나 프레임웍을 사용하게 된다면 공유를 통해 해결할 수 있지만 서로 다른 언어를 가지고 개발하게 된다면 코드가 중복되는 현상이 발생할 수 있다.
 - 비동기로 동작하는 특성상 각각의 서비스에 대한 테스트는 쉬우나 전체적인 테스트는 어려움이 따른다.
 - 수많은 배포작업이 수반된다. 릴리즈가 개별적으로 이루어지는 특성상 이를 별도의 운영팀에서 일괄적으로 관리하는것은 불가능에 가깝우며 일련의 작업들을 자동화 시키지 않으면 과다한 업무량이 발생하게 되며, 이를 해결하기 위해 마이크로서비스 개발에 있어서 DevOps의 도입은 필수요소이다.
 - 트랜젝션 아마 이 부분이 제일 처리하기 난감한 부분일 것이다. 일반적인 모놀리식 아키텍쳐를 사용한 프로젝트라면 RDBMS의 트랜젝션을 사용해 에러가 발생시 rollback하면 그만이다. 하지만 마이크로서비스의 경우는 이 부분에 대해서 많은 고민이 필요하다.

## 마무리
 정말 수 많은 프로그래밍 아키텍쳐가 존재한다. 그 중에서 어떤 것이 가장 좋은 것이냐 묻는다면 확실하게 답하기 매우 어려울 것이다. 그 수많은 아케틱쳐들 중에 자신의 프로그램에 가장 적합한 아키텍쳐를 선택해서 개발하면 그게 가장 좋은 아키텍쳐라고 생각한다.

 문제점이 있다면 가감없이 지적해주시기 바랍니다. 항상 감사한 마음으로 수용하며 공부하겠습니다. 감사합니다.

## Reference
 - [마이크로서비스가 가져올 미래의 개발 패러다임](http://www.moreagile.net/2014/10/microservices.html)
 - [Microservices](http://martinfowler.com/articles/microservices.html)
 - [대용량 웹서비스를 위한 마이크로 서비스 아키텍쳐의 이해](http://bcho.tistory.com/948)
 - [마이크로서비스 아키텍처](http://guruble.com/?p=951)
